@base <https://raw.githubusercontent.com/louspringer/ontology-framework/main/guidance/modules/ontology_tracking#> .

@prefix : <./#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix tracking: <./ontology_tracking#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

# Current Status
:currentStatus a tracking:OntologyStatus ;
    rdfs:label "Current Ontology Framework Status" ;
    rdfs:comment "Status as of current timestamp" ;
    tracking:hasConsumptionStatus :currentConsumptionStatus ;
    tracking:hasTestingStatus :currentTestingStatus .

:currentConsumptionStatus a tracking:ConsumptionStatus ;
    rdfs:label "Current Consumption Status" ;
    rdfs:comment "GraphDB consumption status" ;
    tracking:lastLoaded "2024-03-21T15:30:00+00:00"^^xsd:dateTime .

:currentTestingStatus a tracking:TestingStatus ;
    rdfs:label "Current Testing Status" ;
    rdfs:comment "Testing status for all modules" ;
    tracking:errorCount 35 ;
    tracking:lastTested "2024-03-21T15:30:00+00:00"^^xsd:dateTime ;
    tracking:testResult "FAIL" ;
    tracking:hasValidationResult :syntaxValidationResult,
                               :shapeValidationResult,
                               :instanceValidationResult .

:syntaxValidationResult a tracking:ValidationResult ;
    rdfs:label "Syntax Validation" ;
    tracking:priority "HIGH" ;
    tracking:ruleResult "FAIL" ;
    tracking:validationRule "TURTLE_SYNTAX" ;
    tracking:errorMessage "Multiple files have syntax errors including malformed IRIs and invalid SHACL shapes" .

:shapeValidationResult a tracking:ValidationResult ;
    rdfs:label "SHACL Shape Validation" ;
    tracking:priority "HIGH" ;
    tracking:ruleResult "FAIL" ;
    tracking:validationRule "SHACL_SHAPES_PRESENT" ;
    tracking:errorMessage "Several modules missing required SHACL shapes" .

:instanceValidationResult a tracking:ValidationResult ;
    rdfs:label "Instance Validation" ;
    tracking:priority "MEDIUM" ;
    tracking:ruleResult "FAIL" ;
    tracking:validationRule "EXAMPLE_INSTANCES" ;
    tracking:errorMessage "Multiple classes missing required example instances" .

:exampleOntologyStatus1 a tracking:OntologyStatus  ;
    rdfs:label "Example OntologyStatus 1" ;
    rdfs:comment "This is example instance 1 of class OntologyStatus" ;
    tracking:hasConsumptionStatus :exampleConsumptionStatus1 ;
    tracking:hasTestingStatus :exampleTestingStatus1 .

:exampleOntologyStatus2 a tracking:OntologyStatus  ;
    rdfs:label "Example OntologyStatus 2" ;
    rdfs:comment "This is example instance 2 of class OntologyStatus" ;
    tracking:hasConsumptionStatus :exampleConsumptionStatus2 ;
    tracking:hasTestingStatus :exampleTestingStatus2 .

tracking:ConsumptionStatusShape a sh:NodeShape  ;
    sh:property [
        sh:datatype xsd:dateTime ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:path tracking:lastLoaded
    ] ;
    sh:targetClass tracking:ConsumptionStatus .

tracking:OntologyStatusShape a sh:NodeShape ;
    sh:property [
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:path tracking:hasConsumptionStatus
    ] ;
    sh:property [
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:path tracking:hasTestingStatus
    ] ;
    sh:targetClass tracking:OntologyStatus .

tracking:OntologyTracking a owl:Ontology ;
    rdfs:label "Ontology Tracking Module" ;
    rdfs:comment "Tracks the status of ontologies in the repository, including consumption and testing status" ;
    owl:versionInfo "1.0.0" .

<./ontology_tracking#OntologyTracking#ModuleShape> a sh:NodeShape ;
    sh:property [
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:path <./ontology_tracking#OntologyTracking#label>
    ] ;
    sh:property [
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:path <./ontology_tracking#OntologyTracking#description>
    ] ;
    sh:property [
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:path <./ontology_tracking#OntologyTracking#version>
    ] ;
    sh:targetClass <./ontology_tracking#OntologyTracking#Module> .

tracking:TestingStatusShape a sh:NodeShape ;
    sh:property [
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:path tracking:testResult ;
        sh:pattern "^(PASS|FAIL|UNKNOWN)$"
    ] ;
    sh:property [
        sh:datatype xsd:integer ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:path tracking:errorCount
    ] ;
    sh:property [
        sh:minCount 0 ;
        sh:path tracking:hasValidationResult
    ] ;
    sh:property [
        sh:datatype xsd:dateTime ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:path tracking:lastTested
    ] ;
    sh:targetClass tracking:TestingStatus .

tracking:ValidationResultShape a sh:NodeShape ;
    sh:property [
        sh:maxCount 1 ;
        sh:minCount 0 ;
        sh:path tracking:errorMessage
    ] ;
    sh:property [
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:path tracking:priority ;
        sh:pattern "^(HIGH|MEDIUM|LOW)$"
    ] ;
    sh:property [
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:path tracking:validationRule
    ] ;
    sh:property [
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:path tracking:ruleResult ;
        sh:pattern "^(PASS|FAIL)$"
    ] ;
    sh:targetClass tracking:ValidationResult .

tracking:exampleOntologyStatus a tracking:OntologyStatus ;
    tracking:hasConsumptionStatus tracking:exampleConsumptionStatus ;
    tracking:hasTestingStatus tracking:exampleTestingStatus .

:exampleConsumptionStatus1 a tracking:ConsumptionStatus  ;
    rdfs:label "Example ConsumptionStatus 1" ;
    rdfs:comment "This is example instance 1 of class ConsumptionStatus" ;
    tracking:lastLoaded "2024-03-21T12:00:01+00:00"^^xsd:dateTime .

:exampleConsumptionStatus2 a tracking:ConsumptionStatus  ;
    rdfs:label "Example ConsumptionStatus 2" ;
    rdfs:comment "This is example instance 2 of class ConsumptionStatus" ;
    tracking:lastLoaded "2024-03-21T12:00:02+00:00"^^xsd:dateTime .

:exampleTestingStatus1 a tracking:TestingStatus  ;
    rdfs:label "Example TestingStatus 1" ;
    rdfs:comment "This is example instance 1 of class TestingStatus" ;
    tracking:errorCount 1 ;
    tracking:hasValidationResult :exampleValidationResult1 ;
    tracking:lastTested "2024-03-21T12:00:01+00:00"^^xsd:dateTime ;
    tracking:testResult "Example value 1" .

:exampleTestingStatus2 a tracking:TestingStatus  ;
    rdfs:label "Example TestingStatus 2" ;
    rdfs:comment "This is example instance 2 of class TestingStatus" ;
    tracking:errorCount 2 ;
    tracking:hasValidationResult :exampleValidationResult2 ;
    tracking:lastTested "2024-03-21T12:00:02+00:00"^^xsd:dateTime ;
    tracking:testResult "Example value 2" .

:exampleValidationResult1 a tracking:ValidationResult  ;
    rdfs:label "Example ValidationResult 1" ;
    rdfs:comment "This is example instance 1 of class ValidationResult" ;
    tracking:errorMessage "Example value 1" ;
    tracking:priority "Example value 1" ;
    tracking:ruleResult "Example value 1" ;
    tracking:validationRule "Example value 1" .

:exampleValidationResult2 a tracking:ValidationResult  ;
    rdfs:label "Example ValidationResult 2" ;
    rdfs:comment "This is example instance 2 of class ValidationResult" ;
    tracking:errorMessage "Example value 2" ;
    tracking:priority "Example value 2" ;
    tracking:ruleResult "Example value 2" ;
    tracking:validationRule "Example value 2" .

tracking:errorCount a owl:DatatypeProperty ;
    rdfs:label "error count" ;
    rdfs:comment "Number of errors found in the last test run" ;
    rdfs:domain tracking:TestingStatus ;
    rdfs:range xsd:integer ;
    owl:versionInfo "1.0.0" .

tracking:errorMessage a owl:DatatypeProperty ;
    rdfs:label "error message" ;
    rdfs:comment "Detailed error message if validation failed" ;
    rdfs:domain tracking:ValidationResult ;
    rdfs:range xsd:string ;
    owl:versionInfo "1.0.0" .

tracking:exampleConsumptionStatus a tracking:ConsumptionStatus ;
    tracking:lastLoaded "2024-04-17T12:00:00+00:00"^^xsd:dateTime .

tracking:exampleTestingStatus a tracking:TestingStatus ;
    tracking:errorCount 0 ;
    tracking:hasValidationResult tracking:exampleValidationResult ;
    tracking:lastTested "2024-04-17T12:00:00+00:00"^^xsd:dateTime ;
    tracking:testResult "PASS" .

tracking:exampleValidationResult a tracking:ValidationResult ;
    tracking:priority "LOW" ;
    tracking:ruleResult "PASS" ;
    tracking:validationRule "SHACL_SHAPE_VALID" .

tracking:hasConsumptionStatus a owl:ObjectProperty ;
    rdfs:label "has consumption status" ;
    rdfs:comment "Links an ontology to its consumption status" ;
    rdfs:domain tracking:OntologyStatus ;
    rdfs:range tracking:ConsumptionStatus ;
    owl:versionInfo "1.0.0" .

tracking:hasTestingStatus a owl:ObjectProperty ;
    rdfs:label "has testing status" ;
    rdfs:comment "Links an ontology to its testing status" ;
    rdfs:domain tracking:OntologyStatus ;
    rdfs:range tracking:TestingStatus ;
    owl:versionInfo "1.0.0" .

tracking:hasValidationResult a owl:ObjectProperty ;
    rdfs:label "has validation result" ;
    rdfs:comment "Links a testing status to its validation results" ;
    rdfs:domain tracking:TestingStatus ;
    rdfs:range tracking:ValidationResult ;
    owl:versionInfo "1.0.0" .

tracking:lastLoaded a owl:DatatypeProperty ;
    rdfs:label "last loaded" ;
    rdfs:comment "Timestamp of when the ontology was last loaded into GraphDB" ;
    rdfs:domain tracking:ConsumptionStatus ;
    rdfs:range xsd:dateTime ;
    owl:versionInfo "1.0.0" .

tracking:lastTested a owl:DatatypeProperty ;
    rdfs:label "last tested" ;
    rdfs:comment "Timestamp of when the ontology was last tested" ;
    rdfs:domain tracking:TestingStatus ;
    rdfs:range xsd:dateTime ;
    owl:versionInfo "1.0.0" .

tracking:priority a owl:DatatypeProperty ;
    rdfs:label "priority" ;
    rdfs:comment "Priority level for addressing issues (HIGH/MEDIUM/LOW)" ;
    rdfs:domain tracking:ValidationResult ;
    rdfs:range xsd:string ;
    owl:versionInfo "1.0.0" .

tracking:ruleResult a owl:DatatypeProperty ;
    rdfs:label "rule result" ;
    rdfs:comment "Result of the validation rule (PASS/FAIL)" ;
    rdfs:domain tracking:ValidationResult ;
    rdfs:range xsd:string ;
    owl:versionInfo "1.0.0" .

tracking:testResult a owl:DatatypeProperty ;
    rdfs:label "test result" ;
    rdfs:comment "Result of the last test run (PASS/FAIL/UNKNOWN)" ;
    rdfs:domain tracking:TestingStatus ;
    rdfs:range xsd:string ;
    owl:versionInfo "1.0.0" .

tracking:validationRule a owl:DatatypeProperty ;
    rdfs:label "validation rule" ;
    rdfs:comment "Identifier of the validation rule that was checked" ;
    rdfs:domain tracking:ValidationResult ;
    rdfs:range xsd:string ;
    owl:versionInfo "1.0.0" .

tracking:ConsumptionStatus a owl:Class ;
    rdfs:label "Consumption Status" ;
    rdfs:comment "Tracks whether an ontology has been loaded into GraphDB" ;
    owl:versionInfo "1.0.0" .

tracking:OntologyStatus a owl:Class ;
    rdfs:label "Ontology Status" ;
    rdfs:comment "Represents the current status of an ontology in the system" ;
    owl:versionInfo "1.0.0" .

tracking:TestingStatus a owl:Class ;
    rdfs:label "Testing Status" ;
    rdfs:comment "Tracks the testing status of an ontology" ;
    owl:versionInfo "1.0.0" .

tracking:ValidationResult a owl:Class ;
    rdfs:label "Validation Result" ;
    rdfs:comment "Detailed results from validation checks" ;
    owl:versionInfo "1.0.0" .

[] a sh:NodeShape ;
    sh:property [
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:path owl:versionInfo
    ] ;
    sh:property [
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:path rdfs:label
    ] ;
    sh:property [
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:path rdfs:comment
    ] ;
    sh:targetClass owl:Class .

[] a sh:NodeShape ;
    sh:property [
        sh:minCount 1 ;
        sh:path rdfs:range
    ] ;
    sh:property [
        sh:minCount 1 ;
        sh:path rdfs:domain
    ] ;
    sh:targetClass rdf:Property .

