@prefix : <http://example.org/guidance#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix dc: <http://purl.org/dc/elements/1.1/> .
@prefix dct: <http://purl.org/dc/terms/> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix meta: <./meta#> .
@prefix metameta: <./metameta#> .
@prefix problem: <./problem#> .
@prefix solution: <./solution#> .
@prefix conversation: <./conversation#> .
@prefix guidance: <./guidance#> .
@prefix comp: <./compliance#> .

# Compliance Standards
comp:ComplianceStandard rdf:type owl:Class ;
    rdfs:label "Compliance Standard" ;
    rdfs:comment "Base class for compliance standards" ;
    owl:versionInfo "1.0.0" .

comp:hasRequirement rdf:type owl:DatatypeProperty ;
    rdfs:label "Has Requirement" ;
    rdfs:domain comp:ComplianceStandard ;
    rdfs:range xsd:string ;
    owl:versionInfo "1.0.0" .

comp:ISO27001 rdf:type owl:Class ;
    rdfs:subClassOf comp:ComplianceStandard ;
    rdfs:label "ISO 27001" ;
    rdfs:comment "Information security management standard" ;
    owl:versionInfo "1.0.0" .

comp:GDPR rdf:type owl:Class ;
    rdfs:subClassOf comp:ComplianceStandard ;
    rdfs:label "GDPR" ;
    rdfs:comment "General Data Protection Regulation" ;
    owl:versionInfo "1.0.0" .

comp:PCI_DSS rdf:type owl:Class ;
    rdfs:subClassOf comp:ComplianceStandard ;
    rdfs:label "PCI DSS" ;
    rdfs:comment "Payment Card Industry Data Security Standard" ;
    owl:versionInfo "1.0.0" .

# Compliance Standard Instances
comp:ISO27001Instance rdf:type comp:ISO27001 ;
    comp:hasRequirement "Error logs must be encrypted" ;
    comp:hasRequirement "Access to error logs must be controlled" ;
    comp:hasRequirement "Error handling processes must be documented" ;
    comp:hasRequirement "Security incidents must be reported" .

comp:GDPRInstance rdf:type comp:GDPR ;
    comp:hasRequirement "Personal data must be protected" ;
    comp:hasRequirement "Data breaches must be reported" ;
    comp:hasRequirement "Data subjects must be notified" ;
    comp:hasRequirement "Data processing must be documented" .

comp:PCI_DSSInstance rdf:type comp:PCI_DSS ;
    comp:hasRequirement "Cardholder data must be protected" ;
    comp:hasRequirement "Access to cardholder data must be restricted" ;
    comp:hasRequirement "Security monitoring must be implemented" ;
    comp:hasRequirement "Security policies must be maintained" .

# SHACL Validation Rules
comp:ComplianceStandardShape rdf:type sh:NodeShape ;
    sh:targetClass comp:ComplianceStandard ;
    sh:property [
        sh:path comp:hasRequirement ;
        sh:minCount 1 ;
        sh:datatype xsd:string ;
    ] . 