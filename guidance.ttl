@prefix : <https://raw.githubusercontent.com/louspringer/ontology-framework/main/guidance#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

# Core Classes
:ValidationRule a owl:Class ;
    rdfs:label "Validation Rule"@en ;
    rdfs:comment "A rule for validating ontology content"@en ;
    owl:versionInfo "1.0.0" .

:ValidationTarget a owl:Class ;
    rdfs:label "Validation Target"@en ;
    rdfs:comment "A target for validation rules"@en ;
    owl:versionInfo "1.0.0" .

:ValidationRuleType a owl:Class ;
    rdfs:label "Validation Rule Type"@en ;
    rdfs:comment "Type of validation rule"@en ;
    owl:versionInfo "1.0.0" .

# Core Properties
:hasPattern a owl:DatatypeProperty ;
    rdfs:label "Has Pattern"@en ;
    rdfs:comment "Pattern for validation"@en ;
    rdfs:domain :ValidationRule ;
    rdfs:range xsd:string ;
    owl:versionInfo "1.0.0" .

:hasMessage a owl:DatatypeProperty ;
    rdfs:label "Has Message"@en ;
    rdfs:comment "Message for validation result"@en ;
    rdfs:domain :ValidationRule ;
    rdfs:range xsd:string ;
    owl:versionInfo "1.0.0" .

:hasPriority a owl:DatatypeProperty ;
    rdfs:label "Has Priority"@en ;
    rdfs:comment "Priority level of the rule"@en ;
    rdfs:domain :ValidationRule ;
    rdfs:range xsd:string ;
    owl:versionInfo "1.0.0" .

:hasRuleType a owl:ObjectProperty ;
    rdfs:label "Has Rule Type"@en ;
    rdfs:comment "Type of the validation rule"@en ;
    rdfs:domain :ValidationRule ;
    rdfs:range :ValidationRuleType ;
    owl:versionInfo "1.0.0" .

:hasTarget a owl:ObjectProperty ;
    rdfs:label "Has Target"@en ;
    rdfs:comment "Target of the validation rule"@en ;
    rdfs:domain :ValidationRule ;
    rdfs:range :ValidationTarget ;
    owl:versionInfo "1.0.0" .

:hasValidator a owl:DatatypeProperty ;
    rdfs:label "Has Validator"@en ;
    rdfs:comment "Validator implementation"@en ;
    rdfs:domain :ValidationRule ;
    rdfs:range xsd:string ;
    owl:versionInfo "1.0.0" .

# Core Rule Types
:SHACL a :ValidationRuleType ;
    rdfs:label "SHACL Rule"@en ;
    rdfs:comment "SHACL-based validation rule"@en .

:STRUCTURAL a :ValidationRuleType ;
    rdfs:label "Structural Rule"@en ;
    rdfs:comment "Structural validation rule"@en .

:SEMANTIC a :ValidationRuleType ;
    rdfs:label "Semantic Rule"@en ;
    rdfs:comment "Semantic validation rule"@en .

:SENSITIVE_DATA a :ValidationRuleType ;
    rdfs:label "Sensitive Data Rule"@en ;
    rdfs:comment "Sensitive data validation rule"@en .

:SYNTAX a :ValidationRuleType ;
    rdfs:label "Syntax Rule"@en ;
    rdfs:comment "Syntax validation rule"@en .

# Core Validation Targets
:ConsistencyValidation a :ValidationTarget ;
    rdfs:label "Consistency Validation"@en ;
    rdfs:comment "Target for consistency validation"@en .

:InstallationValidation a :ValidationTarget ;
    rdfs:label "Installation Validation"@en ;
    rdfs:comment "Target for installation validation"@en .

:SPOREValidation a :ValidationTarget ;
    rdfs:label "SPORE Validation"@en ;
    rdfs:comment "Target for SPORE validation"@en .

:SemanticValidation a :ValidationTarget ;
    rdfs:label "Semantic Validation"@en ;
    rdfs:comment "Target for semantic validation"@en .

:SecurityValidation a :ValidationTarget ;
    rdfs:label "Security Validation"@en ;
    rdfs:comment "Target for security validation"@en .

:SyntaxValidation a :ValidationTarget ;
    rdfs:label "Syntax Validation"@en ;
    rdfs:comment "Target for syntax validation"@en .

# Core Rules
:ConsistencyRule a :ValidationRule ;
    rdfs:label "Consistency Rule"@en ;
    rdfs:comment "Rule for consistency validation"@en ;
    :hasMessage "Consistency validation failed" ;
    :hasPriority "HIGH" ;
    :hasRuleType :SHACL ;
    :hasTarget :ConsistencyValidation ;
    :hasValidator "validate_consistency" .

:InstallationRule a :ValidationRule ;
    rdfs:label "Installation Rule"@en ;
    rdfs:comment "Rule for installation validation"@en ;
    :hasMessage "Installation command validation" ;
    :hasPriority "HIGH" ;
    :hasRuleType :SHACL ;
    :hasTarget :InstallationValidation ;
    :hasValidator "validate_installation.py" .

:SPORERule a :ValidationRule ;
    rdfs:label "SPORE Rule"@en ;
    rdfs:comment "Rule for SPORE validation"@en ;
    :hasMessage "SPORE validation failed" ;
    :hasPriority "HIGH" ;
    :hasRuleType :STRUCTURAL ;
    :hasTarget :SPOREValidation ;
    :hasValidator "validate_spore" .

:SemanticRule a :ValidationRule ;
    rdfs:label "Semantic Rule"@en ;
    rdfs:comment "Rule for semantic validation"@en ;
    :hasMessage "Semantic validation failed" ;
    :hasPriority "HIGH" ;
    :hasRuleType :SEMANTIC ;
    :hasTarget :SemanticValidation ;
    :hasValidator "validate_semantic" .

:SensitiveDataRule a :ValidationRule ;
    rdfs:label "Sensitive Data Detection"@en ;
    rdfs:comment "Rule for detecting sensitive data patterns"@en ;
    :hasMessage "Sensitive data detected in literal value" ;
    :hasPattern "\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b",
        "\\b\\d{3}-\\d{2}-\\d{4}\\b",
        "\\b\\d{4}-\\d{4}-\\d{4}-\\d{4}\\b" ;
    :hasPriority "HIGH" ;
    :hasRuleType :SENSITIVE_DATA ;
    :hasTarget :SecurityValidation ;
    :hasValidator "validate_sensitive_data"^^xsd:string .

:SyntaxRule a :ValidationRule ;
    rdfs:label "Syntax Rule"@en ;
    rdfs:comment "Rule for syntax validation"@en ;
    :hasMessage "Syntax validation failed" ;
    :hasPriority "HIGH" ;
    :hasRuleType :SYNTAX ;
    :hasTarget :SyntaxValidation ;
    :hasValidator "validate_syntax" .

# Validation Rule Shape
:ValidationRuleShape a sh:NodeShape ;
    sh:targetClass :ValidationRule ;
    sh:property [
        sh:path :hasRuleType ;
        sh:class :ValidationRuleType ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Validation rule must have a rule type"
    ], [
        sh:path :hasPriority ;
        sh:datatype xsd:string ;
        sh:in ( "HIGH" "MEDIUM" "LOW" ) ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Priority must be HIGH, MEDIUM, or LOW"
    ], [
        sh:path :hasMessage ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Validation rule must have a message"
    ], [
        sh:path :hasValidator ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Validation rule must have a validator"
    ], [
        sh:path :hasTarget ;
        sh:class :ValidationTarget ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Validation rule must have a target"
    ] .

# Validation Target Shape
:ValidationTargetShape a sh:NodeShape ;
    sh:targetClass :ValidationTarget ;
    sh:property [
        sh:path rdfs:label ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Validation target must have a label"
    ], [
        sh:path rdfs:comment ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:message "Validation target must have a comment"
    ] .

# Ontology Metadata
: a owl:Ontology ;
    rdfs:label "Guidance Ontology"@en ;
    rdfs:comment "Ontology for managing guidance and validation rules"@en ;
    owl:versionInfo "1.0.0" .

# RDF/RDFS/OWL Class Relationships
owl:Class rdfs:subClassOf rdfs:Class .
owl:DatatypeProperty rdfs:subClassOf rdf:Property .
owl:ObjectProperty rdfs:subClassOf rdf:Property .

# RDF/RDFS Core Properties
rdf:type a rdf:Property ;
    rdfs:label "RDF Type"@en ;
    rdfs:comment "The subject is an instance of a class"@en ;
    rdfs:domain rdfs:Resource ;
    rdfs:range rdfs:Class .

rdfs:subClassOf a rdf:Property ;
    rdfs:label "RDFS Subclass Of"@en ;
    rdfs:comment "The subject is a subclass of a class"@en ;
    rdfs:domain rdfs:Class ;
    rdfs:range rdfs:Class .

